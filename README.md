# üß©–°–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π


–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ `CNN` –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫—É–±–∏–∫–æ–≤ –ª–µ–≥–æ —Ä–∞–∑–º–µ—Ä–æ–º 48x48x1 –≤ –æ–¥–∏–Ω –∏–∑ 10 –∫–ª–∞—Å—Å–æ–≤.


## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

- **–§–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**: 48x48 –ø–∏–∫—Å–µ–ª–µ–π, 1 –∫–∞–Ω–∞–ª (–≥—Ä–∞–¥–∞—Ü–∏–∏ —Å–µ—Ä–æ–≥–æ).
- **–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è**: –¶–µ–ª–æ–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 9, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–µ –∫–ª–∞—Å—Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤**: 10.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–°–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PyTorch –∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª–æ–µ–≤:

- **–í—Ö–æ–¥:** –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 48x48x1.
- **–ü–µ—Ä–≤—ã–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π –±–ª–æ–∫**:
  - –°–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π: Conv2d, 6 –∫–∞–Ω–∞–ª–æ–≤, —è–¥—Ä–æ 3x3.
  - –ê–∫—Ç–∏–≤–∞—Ü–∏—è: ReLU.
  - –ü—É–ª–∏–Ω–≥: AvgPool2d, —è–¥—Ä–æ 2x2.
- **–í—Ç–æ—Ä–æ–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π –±–ª–æ–∫**:
  - –°–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π: Conv2d, 3 –∫–∞–Ω–∞–ª–∞, —è–¥—Ä–æ 3x3.
  - –ê–∫—Ç–∏–≤–∞—Ü–∏—è: ReLU.
  - –ü—É–ª–∏–Ω–≥: MaxPool2d, —è–¥—Ä–æ 2x2.
- **–†–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏–µ**:
  - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–∞—Ä—Ç—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –¥–ª—è –ø–æ–¥–∞—á–∏ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏.
- **–ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–µ —Å–ª–æ–∏ (Fully Connected Layers)**:
  - –°–ª–æ–π 1: 300 –≤—Ö–æ–¥–æ–≤ ‚Üí 120 –≤—ã—Ö–æ–¥–æ–≤, —Å –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π `ReLU`.
  - –°–ª–æ–π 2: 120 –≤—Ö–æ–¥–æ–≤ ‚Üí 84 –≤—ã—Ö–æ–¥–∞, —Å –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π `Sigmoid`.
  - –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π: 84 –≤—Ö–æ–¥–∞ ‚Üí 10 –≤—ã—Ö–æ–¥–æ–≤ (–¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞).
```python
#input 48x48x1
def create_cnn():
    model = nn.Sequential(
        # –ü–µ—Ä–≤—ã–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π: Conv2d, ReLU, AvgPool2d
        nn.Conv2d(in_channels=1, out_channels=6, kernel_size=3),  # out: 46x46x6
        nn.ReLU(),
        nn.AvgPool2d(kernel_size=2),  # out: 24x24x6
        nn.ReLU(),

        # –í—Ç–æ—Ä–æ–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π: Conv2d, ReLU
        nn.Conv2d(in_channels=6, out_channels=3, kernel_size=3),  # out: 21x21x3
        nn.ReLU(),

        # –í—Ç–æ—Ä–æ–π —Å–ª–æ–π –ø—É–ª–∏–Ω–≥–∞: MaxPool2d
        nn.MaxPool2d(kernel_size=2, stride=2),  # out: 10x10x3

        # –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –º–∞—Ç—Ä–∏—Ü—É
        nn.Flatten(),

        # –ü–æ–¥–∞–µ–º –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –≤—Ö–æ–¥ FCL
        nn.Linear(10*10*3, 120),
        nn.ReLU(),
        nn.Linear(120, 84),
        nn.Sigmoid(),
        nn.Linear(84, 10)
    )
    return model
```
## –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞ `SGD` –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å `CrossEntropyLoss`. –í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—É—á–∞—é—â–µ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏.

### –ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è
```python
def train_model(model, dataloader, device=device, num_epoch=NUM_EPOCH, learning_rate=LEARN_RATE):
  model = model.to(device)

  loss_function = nn.CrossEntropyLoss()
  optimizer = optim.SGD(model.parameters(), lr=learning_rate, momentum=0.9)

  acc_history = []


  for epoch in range(num_epoch):
          correct = 0
          total = 0

          for i, batch in enumerate(dataloader):
              images, labels = batch
              images = images.to(device)
              labels = labels.to(device)

              optimizer.zero_grad()

              # –°—á–∏—Ç–∞–µ–º –ª–æ—Å—Å
              predicted_labels = model(images)
              loss = loss_function(predicted_labels, labels)

              loss.backward()

              # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
              optimizer.step()

              # –ü–æ–¥—Å—á–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç–∏
              _, predicted = predicted_labels.max(1) # –ü–æ —Å—Ç–æ–ª–±—Ü–∞–º –≤—ã–±–∏—Ä–∞–µ–º –∏–Ω–¥–µ–∫—Å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è–Ω–æ—Å—Ç—å—é
              total += labels.size(0)
              correct += predicted.eq(labels).sum().item()

          # –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ —ç–ø–æ—Ö–µ
          acc = correct / total
          acc_history.append(acc)

  return model, acc_history
```
## –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –æ–Ω–∞ –æ–±–æ–±—â–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ.
### –ö–æ–¥ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏
```python
def evaluate_model(model, dataloader, device=device):
    model = model.to(device)
    model.eval()  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ–¥–µ–ª—å –≤ —Ä–µ–∂–∏–º –æ—Ü–µ–Ω–∫–∏

    correct = 0
    total = 0

    with torch.no_grad():
        for images, labels in dataloader:
            images = images.to(device)
            labels = labels.to(device)

            predicted_labels = model(images)

            _, predicted = predicted_labels.max(1)  # –í—ã–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é

            # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
            total += labels.size(0)
            correct += predicted.eq(labels).sum().item()

    accuracy = correct / total  # –í—ã—á–∏—Å–ª—è–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å

    return accuracy
```
## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
**–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** 100% (–¥–∞—Ç–∞—Å–µ—Ç –¥–æ–≤–æ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π)

**–¢–∞–∫–∂–µ –±—ã–ª –ø–æ—Å—Ç—Ä–æ–µ–Ω –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —ç–ø–æ—Ö–∏ –æ–±—É—á–µ–Ω–∏—è:**
![image](https://github.com/user-attachments/assets/767a596e-cb10-4043-9b7e-40028cab305f)
